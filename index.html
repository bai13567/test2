<!doctype html><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Ambient Gradient Field Â· Debug Speed</title>
<style>
html,body{margin:0;height:100%;overflow:hidden;background:#050505}
canvas{position:fixed;inset:0;display:block}
</style>
<canvas id="c"></canvas>

<script>
(()=>{"use strict";
const C=document.getElementById("c"), ctx=C.getContext("2d",{alpha:false});
const clamp=(x,a,b)=>x<a?a:x>b?b:x;
const lerp=(a,b,t)=>a+(b-a)*t;
const mix3=(A,B,t)=>[lerp(A[0],B[0],t),lerp(A[1],B[1],t),lerp(A[2],B[2],t)];
const rgb=(c,a=1)=>`rgba(${c[0]|0},${c[1]|0},${c[2]|0},${a})`;

// ======================
// ðŸ”¥ DEBUG SPEED CONTROL
// ======================
const SPEED = 12; // â† è°ƒè¯•ç”¨ï¼š5 ç§’å†…æ˜Žæ˜¾å˜åŒ–ï¼›æœ€ç»ˆç‰ˆæ”¹å›ž 1
// ======================

let W=0,H=0,DPR=1;
function resize(){
  DPR=Math.min(devicePixelRatio||1,2);
  W=innerWidth; H=innerHeight;
  C.width=(W*DPR)|0; C.height=(H*DPR)|0;
  C.style.width=W+"px"; C.style.height=H+"px";
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
addEventListener("resize",resize,{passive:true});
resize();

// -------- slow drivers (same logic, faster time) --------
const PHI=1.61803398875, SQ2=1.41421356237, PI=Math.PI;
const s1=(t,a,b,c)=>Math.sin(t*a)+0.72*Math.sin(t*b+1.7)+0.46*Math.sin(t*c+0.31);
function slow01(t,rate,seed){
  const r=rate*(1+0.017*seed);
  const x=s1(t*r, r*PHI*(1+0.011*seed), r*SQ2*(1+0.013*seed), r*PI*(1+0.009*seed));
  return 0.5+0.5*(x/2.15);
}
const ease=x=>x*x*(3-2*x);

// -------- palettes --------
const P0={top:[252,248,242], mid:[238,224,204], low:[214,182,140], ink:[28,22,18]};
const P1={top:[251,246,239], mid:[236,219,196], low:[208,170,126], ink:[26,20,16]};
const P2={top:[252,247,240], mid:[233,214,188], low:[200,162,120], ink:[24,18,14]};

function paletteAt(t){
  const p=ease(slow01(t*SPEED,0.00105,7));
  const q=ease(slow01(t*SPEED,0.00082,9));
  const A=p<0.5?P0:P1, B=p<0.5?P1:P2;
  const tt=p<0.5?p/0.5:(p-0.5)/0.5;
  const top=mix3(A.top,B.top,tt);
  const mid=mix3(A.mid,B.mid,tt);
  const low=mix3(A.low,B.low,tt);
  const ink=mix3(A.ink,B.ink,tt);
  const warm=(q-0.5)*0.045;
  return {
    top:mix3(top,[255,255,255],0.010+warm),
    mid:mix3(mid,[255,255,255],0.008+warm*0.7),
    low:mix3(low,ink,0.058),
    ink
  };
}

function drawAmbient(t){
  const P=paletteAt(t);
  const breathe=1+(slow01(t*SPEED,0.003,3)-0.5)*0.016;

  const gx=W*(0.48+(slow01(t*SPEED,0.0011,5)-0.5)*0.09);
  const gy=H*(0.50+(slow01(t*SPEED,0.0013,6)-0.5)*0.09);

  const base=ctx.createRadialGradient(
    gx,gy,Math.min(W,H)*0.07,
    gx,gy,Math.max(W,H)*0.98
  );
  base.addColorStop(0,rgb(P.top));
  base.addColorStop(0.46,rgb(P.mid));
  base.addColorStop(1,rgb(P.low));
  ctx.fillStyle=base;
  ctx.fillRect(0,0,W,H);

  // weight fields (æ›´å®¹æ˜“è§‚å¯Ÿï¼‰
  ctx.globalCompositeOperation="soft-light";
  [
    [0.62,0.42,0.62,7],
    [0.27,0.24,0.48,11],
    [0.53,0.84,0.72,17],
  ].forEach(n=>{
    const du=(slow01(t*SPEED,0.001,n[3])-0.5)*0.07;
    const dv=(slow01(t*SPEED,0.0012,n[3]+1)-0.5)*0.07;
    const cx=W*(n[0]+du), cy=H*(n[1]+dv);
    const r=Math.max(W,H)*n[2]*(0.95+0.05*breathe);
    const g=ctx.createRadialGradient(cx,cy,0,cx,cy,r);
    g.addColorStop(0,"rgba(255,240,220,0.22)");
    g.addColorStop(0.45,"rgba(255,240,220,0.08)");
    g.addColorStop(1,"rgba(255,255,255,0)");
    ctx.fillStyle=g;
    ctx.fillRect(0,0,W,H);
  });
  ctx.globalCompositeOperation="source-over";
}

let t0=performance.now();
function tick(now){
  requestAnimationFrame(tick);
  const t=(now-t0)*0.001;
  drawAmbient(t);
}
requestAnimationFrame(tick);
})();
</script>