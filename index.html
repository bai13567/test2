<!doctype html>
<html lang="zh">
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Light Warm Ambient Background</title>

<style>
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  background:#f4efe9; /* 非黑背景，避免闪屏 */
}
canvas{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  display:block;
  touch-action:none;
}
</style>

<canvas id="c"></canvas>

<script>
(()=>{

const c = document.getElementById("c");
const gl = c.getContext("webgl",{antialias:false,alpha:false});
if(!gl) return;

const V = `
attribute vec2 p;
void main(){ gl_Position = vec4(p,0.,1.); }
`;

const F = `
precision highp float;
uniform vec2 r;
uniform float t;

/* smooth noise */
float h(vec2 p){ return fract(sin(dot(p,vec2(127.1,311.7)))*43758.5453); }
float n(vec2 p){
  vec2 i=floor(p), f=fract(p);
  f=f*f*(3.-2.*f);
  return mix(
    mix(h(i),h(i+vec2(1,0)),f.x),
    mix(h(i+vec2(0,1)),h(i+vec2(1,1)),f.x),
    f.y
  );
}
float fbm(vec2 p){
  float v=0., a=.6;
  for(int i=0;i<4;i++){
    v+=a*n(p); p*=1.8; a*=.5;
  }
  return v;
}

/* 纯亮暖色系调色板（无暗色） */
vec3 palette(float x){
  vec3 a = vec3(0.96,0.94,0.92); // warm white
  vec3 b = vec3(0.99,0.90,0.78); // cream
  vec3 c = vec3(0.98,0.84,0.70); // champagne
  vec3 d = vec3(0.95,0.80,0.78); // soft rose

  vec3 col = mix(a,b,smoothstep(0.0,0.4,x));
  col = mix(col,c,smoothstep(0.3,0.7,x));
  col = mix(col,d,smoothstep(0.6,1.0,x));
  return col;
}

void main(){
  vec2 uv = gl_FragCoord.xy / r;
  uv = uv*2.0 - 1.0;
  uv.x *= r.x / r.y;

  float base = fbm(uv*1.2 + vec2(0.0,t*0.05));
  float detail = fbm(uv*4.0 - vec2(t*0.08,0.0));

  float mixv = base*0.7 + detail*0.3;

  vec3 col = palette(mixv);

  /* 只允许轻微亮度浮动，不引入暗部 */
  float light = 0.92 + 0.10*detail;
  col *= light;

  col = clamp(col,0.0,1.0);
  col = pow(col,vec3(0.98)); // very gentle gamma

  gl_FragColor = vec4(col,1.0);
}
`;

function sh(t,s){
  const x=gl.createShader(t);
  gl.shaderSource(x,s);
  gl.compileShader(x);
  return x;
}

const P = gl.createProgram();
gl.attachShader(P,sh(gl.VERTEX_SHADER,V));
gl.attachShader(P,sh(gl.FRAGMENT_SHADER,F));
gl.linkProgram(P);
gl.useProgram(P);

/* quad */
const buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER,buf);
gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([
  -1,-1, 1,-1, -1,1,
  -1,1, 1,-1, 1,1
]),gl.STATIC_DRAW);
const loc = gl.getAttribLocation(P,"p");
gl.enableVertexAttribArray(loc);
gl.vertexAttribPointer(loc,2,gl.FLOAT,false,0,0);

const ur = gl.getUniformLocation(P,"r");
const ut = gl.getUniformLocation(P,"t");

function resize(){
  const d = Math.min(2,devicePixelRatio||1);
  const w = (visualViewport?visualViewport.width:innerWidth)*d;
  const h = (visualViewport?visualViewport.height:innerHeight)*d;
  c.width=w; c.height=h;
  gl.viewport(0,0,w,h);
  gl.uniform2f(ur,w,h);
}
addEventListener("resize",resize,{passive:true});
visualViewport && visualViewport.addEventListener("resize",resize,{passive:true});
resize();

let t0 = performance.now();
(function loop(now){
  gl.uniform1f(ut,(now-t0)/1000);
  gl.drawArrays(gl.TRIANGLES,0,6);
  requestAnimationFrame(loop);
})(t0);

})();
</script>
</html>